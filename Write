import com.google.protobuf.ByteString;
import com.google.protobuf.InvalidProtocolBufferException;

import java.io.FileOutputStream;
import java.io.IOException;
import java.io.OutputStream;

public class KafkaMessageToFile {
    public static void main(String[] args) {
        // Assume you have a Protobuf message instance called protobufMessage
        YourProtoMessage protobufMessage = YourProtoMessage.newBuilder()
                .setField1("value1")
                .setField2("value2")
                .build();

        // Convert Protobuf message to bytes
        byte[] protobufBytes = protobufMessage.toByteArray();

        // Write the Protobuf message bytes to a file
        try (OutputStream outputStream = new FileOutputStream("output.bin", true)) {
            // Append the Protobuf message bytes to the file
            outputStream.write(protobufBytes);
            outputStream.write("\n".getBytes()); // Add a new line for readability
        } catch (IOException e) {
            e.printStackTrace(); // Handle the exception properly
        }
    }
}
