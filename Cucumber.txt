WITH TopStudents AS (
    SELECT 
        student_id,
        name,
        math_marks,
        ROW_NUMBER() OVER (ORDER BY math_marks DESC) AS row_num
    FROM 
        students
)
SELECT 
    (SELECT SUM(math_marks) FROM TopStudents WHERE row_num <= 5) AS total_marks,
    student_id,
    name,
    math_marks
FROM 
    TopStudents
WHERE 
    row_num <= 5;


-- Create the students table
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    name VARCHAR(50),
    math_marks INT
);

-- Insert sample data into the students table
-- Insert sample data into the students table
INSERT INTO students (student_id, name, math_marks) VALUES (1, 'Alice', 95);
INSERT INTO students (student_id, name, math_marks) VALUES (2, 'Bob', 90);
INSERT INTO students (student_id, name, math_marks) VALUES (3, 'Charlie', 85);
INSERT INTO students (student_id, name, math_marks) VALUES (4, 'David', 80);
INSERT INTO students (student_id, name, math_marks) VALUES (5, 'Eve', 75);
INSERT INTO students (student_id, name, math_marks) VALUES (6, 'Frank', 70);

-- Commit the changes
COMMIT;

