SELECT 
    main.orderid,
    main.total_fees,
    COALESCE((SELECT fee_amount FROM fee WHERE orderid = main.orderid AND fee_id = 1), 0) AS fee1_amount,
    COALESCE((SELECT fee_amount FROM fee WHERE orderid = main.orderid AND fee_id = 2), 0) AS fee2_amount
FROM (
    SELECT 
        orderid,
        SUM(fee_amount) AS total_fees
    FROM 
        fee
    GROUP BY 
        orderid
) main
