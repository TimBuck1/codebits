def performanceAppRunning = true

while (performanceAppRunning) {
    // Check Docker logs for the presence of "ShutDown"
    def dockerLogs = sh(script: "docker logs performance-app", returnStdout: true).trim()
    
    if (dockerLogs.contains("ShutDown")) {
        echo "Found 'ShutDown' in logs. Exiting loop."
        performanceAppRunning = false
    } else {
        // Check if the container is still running
        performanceAppRunning = sh(script: "docker inspect -f '{{.State.Running}}' performance-app", returnStdout: true).trim() == 'true'
        
        if (performanceAppRunning) {
            echo "Performance app still running. Waiting 30 seconds..."
            sleep(30)
        }
    }
}
